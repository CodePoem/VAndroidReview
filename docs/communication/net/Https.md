# Https

HTTPS 是建立在密码学基础之上的一种安全通信协议，严格来说是基于 HTTP 协议和 SSL/TLS 的组合。

## 为什么需要Https

Http是明文传输，不安全，易遭受中间人攻击。

所以需要 Https 加密传输。

1. 使用对称加密传输不能避免中间人攻击，因为秘钥可以被中间人窃取。
2. 所以还需要使用非对称解密来保护对称加密的秘钥，用公钥加密对称加密的秘钥，传输过程中间人没有私钥就算窃取了公钥也解不了密。
3. 但是中间人还可以自己生成一对公钥私钥，把自己的公钥发给客户端，再用自己的私钥解密得到对称加密的秘钥。
4. 引入 CA 证书，服务端先向证书机构申请证书，然后发送给客户端证书，客户端验证证书。

- 对称加密
共享密钥加密，加密和解密使用相同的密钥。
- 非对称加密
公钥和私钥是成对的，公钥用于加密，私钥用于解密，公钥可以公开，私钥必须私有。

## 传输过程

1. 客户端给出协议版本号、一个客户端生成的随机数（Client random），以及客户端支持的加密方法。
2. 服务器确认双方使用的加密方法，并给出数字证书、以及一个服务器生成的随机数（Server random）。
3. 客户端确认数字证书有效，然后生成一个新的随机数（Premaster secret），并使用数字证书中的公钥，加密这个随机数，发给服务器。
4. 服务器使用自己的私钥，获取客户端丝发来的随机数（即Premaster secret）。
5. 客户端和服务器根据约定的加密方法，使用前面的三个随机数，生成"对话密钥"（session key），用来加密接下来的整个对话过程。
